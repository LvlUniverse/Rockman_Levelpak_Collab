<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>sprWeaponIconsHailBreaker</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-1</depth>
  <persistent>0</persistent>
  <parentName>prtPlayerProjectile</parentName>
  <maskName>mskMegaman</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>event_inherited();
/*
scripts modified for this weapon:
playerHandleSprites (astro crush pose is custom)
entityHandleIced (make non-grounded frozen enemies solid)
playerHandleMovement (ice physics on an entity)
objSolidEntity.create (ice physics on an entity)
playerHandleSliding (ice physics on an entity)
playerStepEventDefault (no weapon swapping while doing the epic pose)
*/

contactDamage = 0;
hailBreakerLock = undefined;
timer = -5;

despawnRange = -1;

opacity = 0;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="1" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///clear lock pools
if (hailBreakerLock != undefined)
    lockPoolRelease(hailBreakerLock);
if instance_exists(parent)
    parent.iFrames = 20;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="2">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>event_inherited();

//if not attached to a player, die
if !instance_exists(parent)
{
    instance_destroy();
    exit;
}

//follow player
x = parent.x;
y = parent.y;

//sprite handling
animFrame = clamp(floor(timer / 5), 0, 2);
with(parent)
    playerHandleSprites("HailBrk");

//invulnerability
parent.iFrames = -1;

if !global.frozen
{
    //if time is stopped, stay where we are
    if isLocked(global.playerFrozen)
        exit;
    
    //create storm at appropriate animation frame
    if timer == 10
    {
        playSFX(sfxHailBreaker);
        var cust = random_range(0, 10);
        for (var p = 0; p &lt;= pi; p += pi / 12)
        {
            with instance_create(x, y, objHailBreakerShot)
            {
                angle = p * 2;
                particleTimer = floor(p * (p + cust));   //i don't care much how this gets evaluated, just that it's unique
            }
        }
        
        // also heal Chill Blocks
        // I had to put this here because really dumb shit was happening when I tried to put it all into Chill Blocks ok
        with(objChillManBlock) if(!dead)
        {
            healthpoints = min(3,healthpoints+1);
            if(breakTimer &gt; -1) breakTimer = -1;
        }
    }
    
    //cold white flash
    if timer &gt;= 10
    {
        if timer &lt; 25
            opacity += 0.03;
        else
            opacity -= 0.03;
    }
    
    //die eventually
    if (timer++ &gt; 40)
        instance_destroy();
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="24">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///when equipped...
if (global.keyShootPressed[playerID] &amp;&amp; !playerIsLocked(PL_LOCK_SHOOT))
{
    //fire a hail breaker, if there's energy left and one isn't already active
    if !instance_exists(objHailBreakerShot) &amp;&amp; !instance_exists(objHailBreaker)
    {
        var w = fireWeapon(0, 0, objHailBreaker, 45, 5, 0, 0);
        if instance_exists(w)
        {
            xspeed = 0;
            yspeed = 0;
            w.hailBreakerLock = lockPoolLock(
                localPlayerLock[PL_LOCK_MOVE],
                localPlayerLock[PL_LOCK_JUMP],
                localPlayerLock[PL_LOCK_SHOOT],
                localPlayerLock[PL_LOCK_CHARGE],
                localPlayerLock[PL_LOCK_GRAVITY],
                localPlayerLock[PL_LOCK_CLIMB],
                localPlayerLock[PL_LOCK_TURN],
                localPlayerLock[PL_LOCK_SLIDE], 
                localPlayerLock[PL_LOCK_PAUSE]);
            w.x = bboxGetXCenter();
            w.y = bboxGetYCenter();
        }
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="22">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///weapon list entry
weaponSetup("HAIL BREAKER", make_color_rgb(164, 228, 252), c_white, sprWeaponIconsHailBreaker, 5);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///cold white screen effect
if opacity != 0
    draw_sprite_ext(sprFlashStopperScreen, 0, view_xview[0] + 128, view_yview[0] + 112,
        1, 1, 0, c_white, ceil(opacity * 4) / 4);

//draw_sprite(sprWilyCastleDots, 0, x, y);
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
